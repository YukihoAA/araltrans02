컨트롤 문자들의 위치...에 대해서는,

두가지 방법이 있습니다.

정확히는 한가지 방법에, 개행만 두가지입니다.



첫째로,

원문 두번 번역방식입니다.

상당히 퍼포먼스 떨어지고 무식한 방법입니다만,

제 머리로는 이정도 생각밖에는 달리 떠오르는게 없더군요.

3패스가 안된다 하셔서 2패스로 생각해 본 방법입니다.


1) 컨트롤 문자가 포함된 원문을 버퍼에 저장해 둡니다.

2) 원문에서 컨트롤 문자들을 다 때어내고, 깨끗해진 원문을 역시 버퍼에 저장해 둡니다. 
물론, 컨트롤 문자들도 따로 저장해 둡니다.

3) 이 둘을 합칩니다. 나중에 다시 분리시켜야 하기 때문에, 둘 사이에 "_" 나 공백 등등 구분기호를 붙여둡니다.
여기까지 1패스입니다.

4) 합친 문장을 통째로 번역합니다.

5) 여기서부터 2패스입니다. 번역된 둘을 원래대로 분리시킵니다.

6) 컨트롤 문자가 포함된 번역문에서, 컨트롤 문자의 위치를 계산합니다.
이렇게 하면 거의 정확하게 위치를 알수 있겠죠?

7) 컨트롤 문자가 없는 깨끗한 번역문에, 아까 계산한 대로 컨트롤 문자들을 배치시킵니다.



이 방식의 장점은, 거의 정확한 위치계산이 가능하고, 특히 이름같은건 완벽하게 정확히 계산됩니다.

생수친구에서는 이름과 대사가 특별한 구분기호 없이 붙어서 같이 출력되기 때문에, 이름 계산은 필수이겠지요.

단점은, 아까 언급한 퍼포먼스 저하 외에, 위치가 완벽하게 맞아 떨어지지는 않는다는 것입니다.

이유는, 컨트롤 문자가 포함된 상태에서의 번역문과, 포함되지 않은 상태에서의 번역문은 약간씩은 다르기 때문입니다. ㅡ.,ㅡ;;

하지만 이 부분은 제가 몇번 번역문을 대조시켜 봤더니, 글자수가 크게 다르지는 않았습니다. 말그대로 약간 다릅니다.

따라서 아마....도 큰 문제는 되지 않을듯 합니다. 랄까, 일단 해보고 보는게 좋겠죠? ^^;;;;




다음, 두번째 방식은, 개행 문자만 놓고 봤을때의 또 다른 처리 방법입니다.

이 경우는, 생수친구처럼 컨트롤 문자가 난무하는 게임이 아닌, 개행 문자만 대사에 있을 경우에 적용되는 방식입니다.

현재 히데님이 만드시는 필터가 아마도 여기에 속할듯 합니다.

우타와레루모노의 경우를 예로 들겠습니다.

우타는 개행문자가 "\n" 이 아닌 "" 입니다.


Capture_BUG.jpg


대사창은 세줄까지만 나오는데, 네줄로 출력되어 저렇게 된 것입니다만,

정확히는 "이를~때문에", 까지가 한 문장인데

"토지를" 부분에서 다음 문자가 대사창을 넘어가지 않도록

게임 프로그램에서 임의로 개행을 넘기고

"때문에," 에서 개행 문자 "" 를 받아

개행을 하기 때문에,

원래 세줄인 문장이 네줄로 출력된 것입니다.

사실, 이것 자체는 별 문제는 없습니다만,

우타같은 경우 저렇게 문장이 너무 길어져 문장끼리 겹치는 정도가 심해지면 튕겨버립니다. ㅡ.,ㅡ;;

그래서 생각해낸 방법입니다.



1) 우선 대사창의 한 줄이 몇문자까지 출력할수 있는지를 알아야 합니다. 이것은 게임마다 다르므로,
사용자가 직접 입력하도록 합니다. 편의상, 대사창의 한줄당 한계 문자수를 A 라 칩시다.
또한, 몇 줄까지 출력할수 있는지도 알아내야 합니다. 이것 역시 사용자가 입력하고, B 라고 칩니다.

2) 원문에서 개행문자를 뺍니다. 1패스입니다.

3) 번역합니다.

4) 2패스입니다. 번역문의 문자수와, 아까 뺀 개행문자의 수를 알아냅니다.

5) 총문자수가 A * B 보다 큰지 알아냅니다.

6) 작으면, 번역문 / (개행문자수+1) 가 한줄의 수입니다. 번역문을 나눠,
한줄 끝에 개행문자를 붙이면 됩니다.

7) 클 경우, A 가 한줄의 수입니다. 번역문을 나눠, 한줄 끝에 개행문자를 붙입니다.
이 경우, 문장겹침현상이 반드시 오지만, 아마도 튕김 현상은 어느정도 사라질 것입니다.



일단 정리해 보면 이렇습니다.

물론 이 외에도 마침표나 쉼표등을 이용한 방법도 있을수 있습니다만,

아마도 제 생각에 컨트롤 문자에서는 첫번째 방법 이외에는 다른 방법은 없을 것이며,

우타와레루모노같은 게임에서는 두번째 방법의 7번은 필수라는 것입니다. (6번은 임의로 다른 방식도 가능합니다만)

참고해 주시고, 질문 있으면 질문해 주세요. 그럼 히데님, 화이팅입니다. ^^
